<div class="dashboard-container">
  <h1>My Spending Dashboard</h1>

  <div class="filters">
    <div class="filter-group">
      <label>Time Period:</label>
      <select [(ngModel)]="selectedPeriod" (change)="onPeriodChange()">
        <option value="all">All Time</option>
        <option value="year">Year</option>
        <option value="month">Month</option>
      </select>
    </div>

    <div class="filter-group" *ngIf="selectedPeriod === 'year' || selectedPeriod === 'month'">
      <label>Year:</label>
      <select [(ngModel)]="selectedYear" (change)="onYearChange()">
        <option value="">Select Year</option>
        <option *ngFor="let year of [2023,2024,2025,2026]" [value]="year">{{ year }}</option>
      </select>
    </div>

    <div class="filter-group" *ngIf="selectedPeriod === 'month'">
      <label>Month:</label>
      <select [(ngModel)]="selectedMonth" (change)="onMonthChange()">
        <option value="">Select Month</option>
        <option value="1">January</option>
        <option value="2">February</option>
        <option value="3">March</option>
        <option value="4">April</option>
        <option value="5">May</option>
        <option value="6">June</option>
        <option value="7">July</option>
        <option value="8">August</option>
        <option value="9">September</option>
        <option value="10">October</option>
        <option value="11">November</option>
        <option value="12">December</option>
      </select>
    </div>
  </div>

  <div class="dashboard-content">
    <div class="chart-section">
      <h2>Spending by Category</h2>
      <div class="pie-chart-container" *ngIf="categorySpends.length > 0">
        <svg class="pie-chart" viewBox="0 0 200 200">
          <g transform="translate(100,100)">
            <circle cx="0" cy="0" r="80" fill="#f0f0f0" />
            <path *ngFor="let segment of getPieSegments(); let i = index"
                  [attr.d]="segment.path"
                  [attr.fill]="segment.color"
                  stroke="white"
                  stroke-width="2"/>
          </g>
        </svg>
        <div class="chart-center">
          <div class="total-amount">${{ totalSpend.toFixed(2) }}</div>
          <div class="total-label">Total Spent</div>
        </div>
      </div>
      <div *ngIf="categorySpends.length === 0" class="no-data">
        <p>No spending data available for the selected period.</p>
      </div>
    </div>

    <div class="legend-section">
      <h3>Category Breakdown</h3>
      <div class="legend">
        <div class="legend-item" *ngFor="let spend of categorySpends">
          <div class="legend-color" [style.background-color]="spend.color"></div>
          <div class="legend-text">
            <span class="category-name">{{ spend.category }}</span>
            <span class="amount">${{ spend.amount.toFixed(2) }}</span>
            <span class="percentage">({{ ((spend.amount / totalSpend) * 100).toFixed(1) }}%)</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>